{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-10-30T20:48:25.685192Z", "invocation_id": "64248ecb-489a-45ea-9f5c-85305a9f2eeb", "invocation_started_at": "2025-10-30T20:48:21.234815Z", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-30T20:48:25.458326Z", "completed_at": "2025-10-30T20:48:25.465397Z"}, {"name": "execute", "started_at": "2025-10-30T20:48:25.467396Z", "completed_at": "2025-10-30T20:48:25.591313Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.19610905647277832, "adapter_response": {}, "message": "Runtime Error in model stg_ticker_sentiment (models\\staging\\stg_ticker_sentiment.sql)\n  Parser Error: syntax error at or near \";\"\n  \n  LINE 12: JOIN silver.stg_news n ON n.id = ts.news_id;\n                                                      ^", "failures": null, "unique_id": "model.market_sentiment.stg_ticker_sentiment", "compiled": true, "compiled_code": "SELECT\r\n  ts.news_id,\r\n  UPPER(ts.ticker) AS ticker,\r\n  CAST(ts.relevance_score AS DOUBLE) AS relevance_score,\r\n  CAST(ts.ticker_sentiment_score AS DOUBLE) AS ticker_sentiment_score,\r\n  ts.ticker_sentiment_label\r\nFROM bronze.bronze_ticker_sentiment ts\r\nJOIN silver.stg_news n ON n.id = ts.news_id;", "relation_name": "\"warehouse\".\"main_silver\".\"stg_ticker_sentiment\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-30T20:48:25.455366Z", "completed_at": "2025-10-30T20:48:25.533247Z"}, {"name": "execute", "started_at": "2025-10-30T20:48:25.545220Z", "completed_at": "2025-10-30T20:48:25.603285Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21911334991455078, "adapter_response": {}, "message": "Runtime Error in model stg_news (models\\staging\\stg_news.sql)\n  Parser Error: syntax error at or near \";\"\n  \n  LINE 38: SELECT * FROM parsed;\n                             ^", "failures": null, "unique_id": "model.market_sentiment.stg_news", "compiled": true, "compiled_code": "WITH base AS (\r\n  SELECT\r\n    id,\r\n    title,\r\n    summary,\r\n    source,\r\n    url,\r\n    time_published,\r\n    CAST(overall_sentiment_score AS DOUBLE) AS overall_sentiment_score,\r\n    overall_sentiment_label,\r\n    topics,\r\n    ingested_at\r\n  FROM bronze.bronze_news\r\n),\r\nparsed AS (\r\n  SELECT\r\n    id,\r\n    title,\r\n    summary,\r\n    source,\r\n    url,\r\n    -- \"20250122T153200\" \u2192 timestamp\r\n    CAST(\r\n      STRPTIME(time_published, '%Y%m%dT%H%M%S')\r\n      AS TIMESTAMP\r\n    ) AT TIME ZONE 'UTC' AS published_ts_utc,\r\n    DATE_TRUNC('day', CAST(STRPTIME(time_published, '%Y%m%dT%H%M%S') AS TIMESTAMP)) AS published_date,\r\n    overall_sentiment_score,\r\n    overall_sentiment_label,\r\n    topics,\r\n    ingested_at\r\n  FROM base\r\n)\r\nSELECT * FROM parsed;", "relation_name": "\"warehouse\".\"main_silver\".\"stg_news\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-30T20:48:25.436507Z", "completed_at": "2025-10-30T20:48:25.549178Z"}, {"name": "execute", "started_at": "2025-10-30T20:48:25.550175Z", "completed_at": "2025-10-30T20:48:25.593336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2230987548828125, "adapter_response": {}, "message": "Runtime Error in model mart_daily_sentiment (models\\marts\\mart_daily_sentiment.sql)\n  Parser Error: syntax error at or near \";\"\n  \n  LINE 40: SELECT * FROM indexing;\n                             ^", "failures": null, "unique_id": "model.market_sentiment.mart_daily_sentiment", "compiled": true, "compiled_code": "WITH per_article AS (\r\n  SELECT\r\n    s.ticker,\r\n    n.published_date,\r\n    -- peso por relev\u00e2ncia do ticker no artigo\r\n    s.ticker_sentiment_score * s.relevance_score AS weighted_score\r\n  FROM silver.stg_ticker_sentiment s\r\n  JOIN silver.stg_news n ON n.id = s.news_id\r\n),\r\nagg AS (\r\n  SELECT\r\n    ticker,\r\n    published_date,\r\n    COUNT(*) AS article_count,\r\n    AVG(weighted_score) AS avg_weighted_score,\r\n    AVG(CASE WHEN weighted_score > 0 THEN weighted_score END) AS avg_pos_score,\r\n    AVG(CASE WHEN weighted_score < 0 THEN weighted_score END) AS avg_neg_score,\r\n    SUM(CASE WHEN weighted_score > 0 THEN 1 ELSE 0 END)::INT AS pos_articles,\r\n    SUM(CASE WHEN weighted_score < 0 THEN 1 ELSE 0 END)::INT AS neg_articles\r\n  FROM per_article\r\n  GROUP BY 1,2\r\n),\r\nindexing AS (\r\n  SELECT\r\n    *,\r\n    -- \u00edndice 0\u2013100 simples p/ visual\r\n    50 + 50 * COALESCE(avg_weighted_score, 0) AS sentiment_index_100\r\n  FROM agg\r\n)\r\nSELECT * FROM indexing;", "relation_name": "\"warehouse\".\"main_gold\".\"mart_daily_sentiment\"", "batch_results": null}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-10-30T20:48:25.452339Z", "completed_at": "2025-10-30T20:48:25.487377Z"}, {"name": "execute", "started_at": "2025-10-30T20:48:25.502329Z", "completed_at": "2025-10-30T20:48:25.602286Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22188973426818848, "adapter_response": {}, "message": "Runtime Error in model mart_ticker_heatmap (models\\marts\\mart_ticker_heatmap.sql)\n  Parser Error: syntax error at or near \";\"\n  \n  LINE 27: WHERE d.published_date >= l.last_date - INTERVAL 30 DAY;\n                                                                  ^", "failures": null, "unique_id": "model.market_sentiment.mart_ticker_heatmap", "compiled": true, "compiled_code": "WITH latest AS (\r\n  SELECT\r\n    ticker,\r\n    MAX(published_date) AS last_date\r\n  FROM gold.mart_daily_sentiment\r\n  GROUP BY 1\r\n)\r\nSELECT\r\n  d.ticker,\r\n  d.published_date,\r\n  d.article_count,\r\n  d.avg_weighted_score,\r\n  d.sentiment_index_100\r\nFROM gold.mart_daily_sentiment d\r\nJOIN latest l\r\n  ON d.ticker = l.ticker\r\nWHERE d.published_date >= l.last_date - INTERVAL 30 DAY;", "relation_name": "\"warehouse\".\"main_gold\".\"mart_ticker_heatmap\"", "batch_results": null}], "elapsed_time": 0.8917839527130127, "args": {"use_colors_file": true, "macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": true, "exclude": [], "use_colors": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_yaml_configuration_for_mf_time_spines": false, "log_path": "dbt\\logs", "require_resource_names_without_spaces": true, "quiet": false, "defer": false, "partial_parse_file_diff": true, "validate_macro_args": false, "favor_state": false, "project_dir": "dbt", "printer_width": 80, "show_all_deprecations": false, "invocation_command": "dbt run --project-dir dbt --profiles-dir dbt", "use_fast_test_edges": false, "vars": {}, "select": [], "populate_cache": true, "profiles_dir": "dbt", "indirect_selection": "eager", "log_file_max_bytes": 10485760, "version_check": true, "print": true, "partial_parse": true, "show_resource_report": false, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "upload_to_artifacts_ingest_api": false, "which": "run", "strict_mode": false, "empty": false, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "static_parser": true, "write_json": true, "require_nested_cumulative_type_params": false, "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "send_anonymous_usage_stats": true, "require_generic_test_arguments_property": true, "log_format_file": "debug"}}